<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1click_shop.tj</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f5f5;
    }
    .product img {
      max-width: 100%;
      border-radius: 8px;
    }
    .product {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .nav-link {
      color: white !important;
    }
    #cart-modal {
      display: none;
    }
    #cart-modal.active {
      display: block;
      position: fixed;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      z-index: 1050;
      padding: 1rem;
      max-width: 500px;
      width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">1click_shop.tj</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="#profile">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
        <li class="nav-item"><a class="nav-link" id="cart-counter" href="#">üõí –ö–æ—Ä–∑–∏–Ω–∞ (0)</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container my-4">
  <div class="row" id="products">
    <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
  </div>

  <div id="profile" class="my-4">
    <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –í—Ö–æ–¥</h3>
    <form id="auth-form">
      <input type="text" id="user-name" placeholder="–í–∞—à–µ –∏–º—è" class="form-control mb-2" required>
      <input type="email" id="user-email" placeholder="Email" class="form-control mb-2" required>
      <button class="btn btn-success">–í–æ–π—Ç–∏</button>
    </form>
    <div id="user-info" class="mt-3 d-none">
      <h5>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, <span id="client-name"></span></h5>
      <p>Email: <span id="client-email"></span></p>
    </div>
  </div>

  <form id="order-form" class="my-4">
    <h4>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h4>
    <input type="text" name="address" placeholder="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏" class="form-control mb-2" required>
    <input type="text" name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" class="form-control mb-2" required>
    <select name="payment" class="form-control mb-2" required>
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</option>
      <option value="–ù–∞–ª–æ–∂–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂">–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</option>
      <option value="–û–Ω–ª–∞–π–Ω-–∫–∞—Ä—Ç–∞">–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π</option>
    </select>
    <button type="submit" class="btn btn-primary">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
  </form>
</div>

<div id="cart-modal" class="container bg-light">
  <h4>–ö–æ—Ä–∑–∏–Ω–∞</h4>
  <ul id="cart-items" class="list-group mb-2"></ul>
  <p id="total-price">–ò—Ç–æ–≥–æ: 0 —Å–æ–º–æ–Ω–∏</p>
  <button id="submit-from-cart" class="btn btn-success">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
  <button id="close-cart" class="btn btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
const BOT_TOKEN = "7643630743:AAG7AlSv67X-dLAXPu0UbVGXPY2QZlOrlLc" ;
const CHAT_ID = "5116176110";

let cart = [];

const userInfo = document.getElementById('user-info');
const clientName = document.getElementById('client-name');
const clientEmail = document.getElementById('client-email');
const authForm = document.getElementById('auth-form');
const orderForm = document.getElementById('order-form');
const products = [
  { name: '–ß–µ—Ö–æ–ª –°ristian Dior', price: 30, img: 'https://i.postimg.cc/YSvYG984/photo-2025-06-24-21-14-32.jpg' },
  { name: '–õ–∏–ø—É—á–∫–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞', price: 10, img: 'https://i.postimg.cc/L6f7q67C/photo-2025-06-25-02-49-11-1.jpg' },
  { name: "–ß–µ—Ö–æ–ª Gucci –¥–ª—è iPhone" , price: 60, img: "https://i.postimg.cc/X73hC0bn/photo-2025-06-25-02-52-51.jpg"}
  ];

document.addEventListener('DOMContentLoaded', () => {
  const cartCounter = document.getElementById('cart-counter');
  const cartModal = document.getElementById('cart-modal');
  const cartItems = document.getElementById('cart-items');
  const totalPriceEl = document.getElementById('total-price');
  const closeCartBtn = document.getElementById('close-cart');
  const submitFromCart = document.getElementById('submit-from-cart');

  function updateCart() {
    cartItems.innerHTML = '';
    let total = 0;
    cart.forEach((item, i) => {
      total += item.price * item.quantity;
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.innerHTML = `${item.name} ‚Äî ${item.price} —Å–æ–º–æ–Ω–∏ x ${item.quantity}
        <button class='btn btn-sm btn-outline-secondary mx-1' onclick='changeQuantity(${i}, 1)'>+</button>
        <button class='btn btn-sm btn-outline-secondary mx-1' onclick='changeQuantity(${i}, -1)'>‚àí</button>
        <button class='btn btn-sm btn-outline-danger' onclick='removeItem(${i})'>√ó</button>`;
      cartItems.appendChild(li);
    });
    totalPriceEl.textContent = `–ò—Ç–æ–≥–æ: ${total.toFixed(2)} —Å–æ–º–æ–Ω–∏`;
    cartCounter.textContent = `üõí –ö–æ—Ä–∑–∏–Ω–∞ (${cart.reduce((s, i) => s + i.quantity, 0)})`;
  }

  window.changeQuantity = (i, d) => {
    cart[i].quantity += d;
    if (cart[i].quantity <= 0) cart.splice(i, 1);
    updateCart();
  };

  window.removeItem = (i) => {
    cart.splice(i, 1);
    updateCart();
  };

  cartCounter.onclick = () => cartModal.classList.add('active');
  closeCartBtn.onclick = () => cartModal.classList.remove('active');

  products.forEach((p, i) => {
    const col = document.createElement('div');
    col.className = 'col-md-4';
    col.innerHTML = `
      <div class="product p-3">
        <img src="${p.img}" alt="${p.name}" />
        <h5>${p.name}</h5>
        <p>–¶–µ–Ω–∞: ${p.price} —Å–æ–º–æ–Ω–∏</p>
        <button class="btn btn-primary" onclick='addToCart(${i})'>–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
      </div>
    `;
    document.getElementById('products').appendChild(col);
  });

  window.addToCart = (i) => {
    const item = products[i];
    const exist = cart.find(c => c.name === item.name);
    if (exist) exist.quantity++;
    else cart.push({ ...item, quantity: 1 });
    updateCart();
    alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É');
  };

  authForm.addEventListener('submit', e => {
    e.preventDefault();
    const name = document.getElementById('user-name').value.trim();
    const email = document.getElementById('user-email').value.trim();
    if (!name || !email) return;
    localStorage.setItem('userName', name);
    localStorage.setItem('userEmail', email);
    showUserInfo();
  });

  function showUserInfo() {
    const name = localStorage.getItem('userName');
    const email = localStorage.getItem('userEmail');
    if (name && email) {
      clientName.textContent = name;
      clientEmail.textContent = email;
      userInfo.classList.remove('d-none');
      authForm.classList.add('d-none');
    }
  }

  showUserInfo();

  orderForm.addEventListener('submit', e => {
    e.preventDefault();
    if (cart.length === 0) return alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');

    const name = localStorage.getItem('userName');
    const email = localStorage.getItem('userEmail');
    const phone = orderForm.phone.value;
    const address = orderForm.address.value;
    const payment = orderForm.payment.value;

    const items = cart.map(i => `${i.name} x ${i.quantity} = ${i.price * i.quantity} —Å–æ–º–æ–Ω–∏`).join('%0A');
    const total = cart.reduce((s, i) => s + i.price * i.quantity, 0);

    const msg = `üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –æ—Ç ${name}%0Aüìß ${email}%0Aüìû ${phone}%0Aüìç ${address}%0Aüí≥ ${payment}%0Aüì¶ –¢–æ–≤–∞—Ä—ã:%0A${items}%0Aüí∞ –ò—Ç–æ–≥–æ: ${total} —Å–æ–º–æ–Ω–∏`;

    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${msg}&parse_mode=HTML`)
      .then(r => r.ok ? alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!') : alert('–û—à–∏–±–∫–∞'))
      .catch(() => alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏'));

    cart = [];
    updateCart();
    orderForm.reset();
    cartModal.classList.remove('active');
  });
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
